---
phase: 04-devtools-trigger-fix
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/app/(authed)/devtools/page.tsx
  - showcase/src/app/template.tsx
autonomous: true
requirements: [WIRE-02, TRIG-05]

must_haves:
  truths:
    - "Dashboard auto-selects client when opened with clientId query param"
    - "Showcase app renders TamboDevTools inside TamboProvider"
  artifacts:
    - path: "apps/web/app/(authed)/devtools/page.tsx"
      provides: "Query param reading and client auto-selection"
      contains: "clientId"
    - path: "showcase/src/app/template.tsx"
      provides: "TamboDevTools integration in showcase"
      contains: "TamboDevTools"
  key_links:
    - from: "apps/web/app/(authed)/devtools/page.tsx"
      to: "useDevtoolsConnection"
      via: "setSelectedSessionId from clientId search param"
      pattern: "searchParams.*clientId"
---

<objective>
Add dashboard client auto-selection from URL and showcase devtools integration.

Purpose: When "Open DevTools" is clicked from trigger, the dashboard should auto-select the correct client. Showcase app needs TamboDevTools for end-to-end demo.
Output: Dashboard reads clientId query param; showcase includes TamboDevTools component.
</objective>

<execution_context>
@/Users/lachlan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/lachlan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-devtools-trigger-fix/04-CONTEXT.md
@apps/web/app/(authed)/devtools/page.tsx
@apps/web/app/(authed)/devtools/hooks/use-devtools-connection.ts
@showcase/src/app/template.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add clientId query param auto-selection to devtools dashboard</name>
  <files>apps/web/app/(authed)/devtools/page.tsx</files>
  <action>
Add query param reading to DevtoolsPage:

1. Import `useSearchParams` from `next/navigation` and `useEffect` from `react`.

2. At the top of the component, read the `clientId` param:

   ```tsx
   const searchParams = useSearchParams();
   const clientIdFromUrl = searchParams.get("clientId");
   ```

3. Add a `useEffect` that auto-selects the client when the param is present and a matching client exists:
   ```tsx
   useEffect(() => {
     if (!clientIdFromUrl) return;
     const clientExists = clients.some((c) => c.sessionId === clientIdFromUrl);
     if (clientExists && !selectedSessionId) {
       setSelectedSessionId(clientIdFromUrl);
     }
   }, [clientIdFromUrl, clients, selectedSessionId, setSelectedSessionId]);
   ```

This ensures that when the dashboard is opened via `?clientId=xxx`, it auto-selects that client without requiring manual selection from the dropdown.
</action>
<verify>Run `npm run check-types -w apps/web` — no type errors</verify>
<done>Dashboard page reads clientId from URL search params and auto-selects matching client on mount</done>
</task>

<task type="auto">
  <name>Task 2: Add TamboDevTools to showcase app</name>
  <files>showcase/src/app/template.tsx</files>
  <action>
Add TamboDevTools to the showcase template:

1. Import `TamboDevTools` from `@tambo-ai/react/devtools`.

2. Add `<TamboDevTools />` inside the `<TamboProvider>` block (after the children div, before closing `</TamboProvider>`), matching the pattern in apps/web/providers/tambo-provider.tsx.

The component should be placed at approximately line 92, just before `</TamboProvider>`:

```tsx
                  <div className="container mx-auto px-4 md:px-6 pt-6">
                    {children}
                  </div>
                  <TamboDevTools />
                </TamboProvider>
```

This enables the showcase to connect to the devtools bridge when the dev server is running.
</action>
<verify>Run `npm run check-types -w showcase` — no type errors</verify>
<done>Showcase app includes TamboDevTools inside TamboProvider, enabling WS bridge connection for end-to-end devtools demo</done>
</task>

</tasks>

<verification>
1. `npm run check-types -w apps/web` passes
2. `npm run check-types -w showcase` passes
3. `npm run lint` passes across workspace
4. DevtoolsPage component reads `clientId` search param
5. Showcase template renders `<TamboDevTools />` inside TamboProvider
</verification>

<success_criteria>

- Opening `/devtools?clientId=xxx` auto-selects the matching SDK client in the dashboard
- Showcase app has TamboDevTools and will connect to bridge when dev server runs
- No type errors across workspace
  </success_criteria>

<output>
After completion, create `.planning/phases/04-devtools-trigger-fix/04-02-SUMMARY.md`
</output>
