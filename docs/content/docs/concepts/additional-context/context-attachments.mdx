---
title: Context Attachments
description: Stage context pieces that will be sent with the next user message
---

Context attachments allow you to stage context pieces that will be automatically included in the `additionalContext` when the next message is sent.

## How context attachments work

Context attachments are automatically registered as a single merged context helper (with the key `contextAttachments`) that returns an array of all active attachments. When you add or remove attachments, the context helper automatically updates to reflect the current state. The attachments will be included in the `additionalContext` when the next user message is sent, and are automatically cleared after submission (one-time use).

### Context Helper Behavior

The `TamboContextAttachmentProvider` automatically registers a context helper with the key `contextAttachments`. This helper:

- Returns an array of all active attachments when there are any
- Returns `null` when there are no attachments
- Automatically updates when attachments are added or removed
- Is included in `additionalContext` when the next message is sent

The context helper structure looks like this:

```json
{
  "contextAttachments": [
    {
      "id": "uuid-1",
      "displayName": "File.txt",
      "context": "The contents of File.txt",
      "type": "file"
    },
    {
      "id": "uuid-2",
      "displayName": "Selection",
      "context": "Selected text content",
      "type": "selection"
    }
  ]
}
```

## Basic Usage

The `useTamboContextAttachment` hook provides methods to manage context attachments:

```tsx
import { useTamboContextAttachment } from "@tambo-ai/react";

function FileViewer({ file }) {
  const { addContextAttachment, removeContextAttachment } =
    useTamboContextAttachment();

  const handleSelectFile = () => {
    addContextAttachment(
      file.content, // context value (string)
      file.name, // display name
      "file", // optional type
    );
  };

  return <button onClick={handleSelectFile}>Focus on {file.name}</button>;
}
```

## Context Attachment Structure

Each context attachment has the following structure:

```tsx
interface ContextAttachment {
  id: string; // Auto-generated unique identifier
  displayName?: string; // Optional display name for UI rendering
  context: string; // The context value that will be used in additionalContext
  type?: string; // Optional type identifier for grouping/rendering
}
```

## Hook API

The `useTamboContextAttachment` hook returns:

```tsx
const {
  attachments, // Array of active context attachments
  addContextAttachment, // Add a new context attachment
  removeContextAttachment, // Remove by ID
  clearContextAttachments, // Remove all attachments
} = useTamboContextAttachment();
```

### Adding Context Attachments

Add a context attachment by calling `addContextAttachment` with a context value, optional display name, and optional type:

```tsx
const { addContextAttachment } = useTamboContextAttachment();

// Simple context attachment without displayName
const attachment = addContextAttachment("The contents of File.txt");

// With displayName
const attachment = addContextAttachment("The contents of File.txt", "File.txt");

// With displayName and type for grouping
const attachment = addContextAttachment(
  "The contents of File.txt",
  "File.txt",
  "file",
);
```

The function returns the `ContextAttachment` object with an auto-generated `id`. All attachments are automatically registered together as a single merged context helper (key: `contextAttachments`) that returns an array of all active attachments. This array will be included in `additionalContext` when the next message is sent.

### Removing Context Attachments

Remove a specific context attachment by its ID. The context helper will automatically update to reflect the change:

```tsx
const { removeContextAttachment } = useTamboContextAttachment();

removeContextAttachment(attachment.id);
```

Or clear all attachments at once:

```tsx
const { clearContextAttachments } = useTamboContextAttachment();

clearContextAttachments();
```

**Note:** Context attachments are automatically cleared after message submission (one-time use). You typically don't need to manually clear them unless you want to remove them before sending a message.

### Accessing Active Attachments

Access the current attachments array:

```tsx
const { attachments } = useTamboContextAttachment();

// Use attachments for UI rendering or other purposes
attachments.forEach((attachment) => {
  console.log(attachment.displayName, attachment.context, attachment.type);
});
```

## Complete Example

Here's a complete example showing context attachments in a file browser:

```tsx
import { useTamboContextAttachment } from "@tambo-ai/react";

function FileBrowser({ files }) {
  const {
    attachments,
    addContextAttachment,
    removeContextAttachment,
    clearContextAttachments,
  } = useTamboContextAttachment();

  const handleFileClick = (file) => {
    // Stage the file content for the next message
    addContextAttachment(file.content, file.name, "file");
  };

  return (
    <div>
      {/* Display active attachments */}
      {attachments.length > 0 && (
        <div>
          <h3>Staged Context:</h3>
          {attachments.map((attachment) => (
            <div key={attachment.id}>
              <span>{attachment.displayName}</span>
              <button onClick={() => removeContextAttachment(attachment.id)}>
                Remove
              </button>
            </div>
          ))}
        </div>
      )}

      {/* File List */}
      <div>
        {files.map((file) => (
          <button key={file.id} onClick={() => handleFileClick(file)}>
            {file.name}
          </button>
        ))}
      </div>
    </div>
  );
}
```
