---
title: Context Attachments
description: Understanding staged, user-controlled context
---

import LearnMore from "@/components/learn-more";
import { Rocket } from "lucide-react";

Context attachments represent a fundamentally different approach to providing context: instead of automatic inclusion or programmatic control, users explicitly stage context they want to include in their next message. Think of it as a clipboard for AI context.

## The Staging Pattern

Imagine a file browser in your application. Users are looking at their documents, and they want to ask the AI a question about a specific file. Without context attachments, they'd need to either:
- Copy and paste the file content into their message (tedious)
- Hope the AI somehow knows about the file (it doesn't)
- Rely on you to automatically include all files (expensive and unnecessary)

Context attachments solve this with a staging pattern: users select what they want to focus on, that context is "staged," and when they send their message, the staged context is included and then automatically cleared.

## Why User-Controlled Context Matters

Not all context should be automatic. Sometimes users know exactly what information is relevant to their question, and they should be able to tell the AI "focus on this."

**File viewers**: "I'm looking at five documents, but I want to ask about this specific one"

**Text selections**: "I've highlighted this paragraph—help me rewrite it"

**Canvas elements**: "I'm working on this specific component—suggest improvements"

**Code editors**: "Look at these three files together—find the bug"

User-controlled context gives users agency. They decide what's relevant, what to include, and when to include it.

## How Context Attachments Work

Context attachments are automatically registered as a context helper behind the scenes. When you add attachments, they become part of a special `contextAttachments` array that's included in the next message's additional context.

The key insight: **attachments are temporary by design**. After the message is sent, they're automatically cleared. This prevents context from "stacking up" across multiple messages and keeps each interaction focused on what the user explicitly chose.

### The Lifecycle

1. **User action**: User clicks "Focus on this file" or selects text
2. **Staged**: Attachment is added to the staged list (visible to user)
3. **Message sent**: Staged attachments are included in `additionalContext`
4. **Auto-clear**: Attachments are automatically removed
5. **Next message**: User can stage new context for the next interaction

This one-time-use pattern matches how people naturally think about providing context: "For *this* question, I want you to know about *this* file."

## Common Use Cases

### File Browsers and Document Viewers

Users browse available files and explicitly select which ones to include:

```tsx
"I have 50 documents, but for this question,
focus on quarterly-report.pdf and budget.xlsx"
```

The AI receives just those two files, not all 50.

### Text Selection and Highlighting

Users highlight sections of content they want to discuss:

```tsx
"I've selected this paragraph from the terms of service.
Can you explain it in simpler terms?"
```

The selected text becomes temporary context.

### Canvas and Workspace Applications

In design tools, code editors, or workspace apps, users focus the AI on specific elements:

```tsx
"I'm working on the UserProfile component.
Suggest improvements for accessibility."
```

The component's current state is staged as context.

### Progressive Context Building

Users can stage multiple pieces of context before sending their message:

```tsx
// User stages:
1. Select diagram.png
2. Select requirements.md
3. Select current-implementation.ts

// Then asks:
"Do these three things align? Any gaps?"
```

All three attachments are included together in one message.

## Comparing to Other Context Methods

| Aspect | Context Attachments | Context Helpers | Resources |
|--------|-------------------|----------------|-----------|
| **Who decides** | User | System/Developer | User |
| **When included** | Once (next message) | Every message | When referenced |
| **Persistence** | One-time use | Automatic per-message | Per-message |
| **Cleared** | Automatically after send | Never (always runs) | N/A (per-message) |
| **User visible** | Yes (staged list) | No (happens automatically) | Yes (@ mention) |

Context attachments sit between automatic helpers and user-referenced resources. They're user-initiated like resources, but staged and temporary like a selection tool.

## The "Clipboard" Mental Model

The best way to think about context attachments is as a clipboard:

- **Copy** (stage): User adds context to the clipboard
- **Paste** (send): Message includes everything on the clipboard
- **Auto-clear** (after send): Clipboard is automatically emptied

This matches how people work with temporary, focused context in other applications.

## When to Use Context Attachments

**Use context attachments when:**
- Users need to explicitly choose what context to include
- Context is temporary and specific to one question
- You want users to see what context has been staged
- Different interactions need different context from the same data set

**Don't use context attachments when:**
- Context should always be included automatically (use context helpers)
- You want to programmatically control context (use manual context)
- Context is large reference material users browse (use resources)

## Implementation

Ready to implement context attachments in your application?

<LearnMore
  title="Use Context Attachments"
  description="Step-by-step guide to implementing staged context"
  href="/guides/additional-context/use-context-attachments"
  icon={Rocket}
/>
